# <center/> 分布式温控系统解决方案 <center/>

[TOC]

## 1. 产品介绍及相关说明

### 1.1 产品背景

某快捷廉价酒店响应节能绿色环保理念，推行自助计费式中央温控系统，使得入住的客户可以根据要求设定温度和风速的调节，同时可以显示所需支付的金额。

### 1.2 产品功能简介

自助式的分布式温控系统，可以让入住的客户根据自己的需求调节房间的温度以及风速，并且可以实时显示出客房空调消耗的能量所产生的费用。当客户退房时，前台可以出具空调的使用详单及账单。空调运行期间，空调管理员能够监控各房间空调的使用状态，此外，酒店经理在需要的情况下可以查看不同时间范围内的格式化统计报表。

### 1.3 缩写说明

> UML：统一建模语言（Unified Modeling Language）是一种面向对象系统的产品进行说明、可视化和编制文档的一种标准语言
>
> ACA：空调管理人员（Air Conditioner Adminstrator）
>
> HM：酒店经理（Hotel Manager）
>
> HC：入住酒店的客户（Hotel Manager）
>
> TCS：自助分布式中央温控系统，简称温控系统（Temperature Control System）

### 1.4 术语定义

> 详单：酒店入住客户使用酒店自助计费式中央温控系统的详细记录，通过详单展现空调的计时、耗电、计费等信息
>
> 统计报表：指酒店按照规定的表格形式、内容、时间报送程序，自上而下统一布置、提供统计资料的一种统计调查方式

### 1.5 引用标准

《需求规格说明书格式标准》

## 2. 产品服务对象

### 2.1 客户

快捷廉价酒店

* 前台：出具账单，结账收费，指引向导
* 酒店经理：有管理、会计等相关知识，对`TCS`的运作不熟悉
* 空调管理员：熟悉`TCS`的运作

### 2.2 用户

入住快捷廉价酒店的房客。成年人为主，入住目的多为旅行、出差，对空调的基本使用有一定了解

## 3. 产品功能需求

### 3.1 主机/中央控制系统

使用对象为前台、管理员和经理。能够处理从机发来的请求，并且根据请求发送相应的命令。根据使用者的不同面板展示不同的内容。

#### 3.1.1 控制功能

| 功能     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 电源控制 | 能够人工启动和关闭整个中央控制系统。开启后及时接收从机消息，关机时从机也不工作。 |
| 参数控制 | 空调启动时，参数默认为上次关机时的参数，也可以设置主机工作参数，然后再进入服务 |
| 参数重制 | 时间记录、参数、计费等异常时可手动重置                       |
| 调节控制 | 根据从控机的请求来自动调节对应客房的空调模式、送风温度及风速 |
| 负载均衡 | 自定义调度算法实现对从机请求的均衡调节                       |

#### 3.1.2 统计功能

| 功能     | 描述                                                     |
| -------- | -------------------------------------------------------- |
| 计算费用 | 按照系统设置的计费标准，实时计算客户使用的费用           |
| 实时反馈 | 计算得到的所需费用能够实时反馈发送给从机                 |
| 统计报表 | 可以生成日报表、周报表、月报表、房间账单、详单等统计报表 |
| 日志记录 | 每分钟记录系统运行的统计信息并持久化到本地               |
| 信息查询 | 房间账单、详单、报表等可以随时查询                       |

#### 3.1.3 监控功能

| 功能     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 数据存储 | 将实时采集到的数据存储到数据库中                             |
| 监视数据 | 能够监视所有客房的空调工作信息，房间实际温度、风速、目标温度等信息 |
| 异常报警 | 对于存在异常如温度失常、机器宕机等情况的房间，能够立即向管理员发出警报 |

### 3.2 从机/子控制系统

使用对象为入住客户。能够根据客户的需求向主机发送请求从而调节空调，面板会显示出房间温度，风速，目标温度，空调模式，所需费用等消息。

说明：不考虑房间大小和管道的分布，在达到目标温度后，房间温度每分钟变化率一定。

#### 3.2.1 调节功能

| 功能     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 状态切换 | 从机随主机开机后默认处于待机状态。使用空调时，从机处于工作状态 |
| 模式切换 | 客户可以切换制冷模式和制热模式                               |
| 温度调节 | 设置目标温度，制冷模式下设置温度范围为18-25度，制热模式下为25-30度 |
| 风速调节 | 可以设置高风、中风和低风三种风速                             |

#### 3.2.2 服务功能

| 功能     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 数据获取 | 自动获取客户输入以及传感器收集的房间温度信息                 |
| 收发消息 | 从机将实时收集到的信息立即发送到主机，接收到主机命令后立即执行 |
| 面板显示 | 温度、模式、风速、目标温度、使用费用、当前时间以及使用时间可显示在面板上 |

## 4. 注意事项

* 温控范围
  * 制冷模式：18-25℃
  * 制热模式：25-30℃
  * 缺省温度：25℃
* 计费标准
  * 1 元 / 度
* 耗电标准
  * 高风：1 度 / 1 分钟
  * 中风：1 度 / 2 分钟
  * 低风：1 度 / 3 分钟
* 室温变化模式
  * 向设定方向变化
    * 低风模式：0.4 ℃ / min
    * 中风模式：0.5 ℃ / min
    * 高风模式：0.6 ℃ / min
* 温度调节按钮
  * 连续2次或多次指令发送时间间隔
    * < 1 s：只发送最后 1 次的指令参数
    * ≥ 1 s：发送 2 次请求
* 房间空调账单格式

| 日期       | 耗电量 | 费用 |
| ---------- | ------ | ---- |
| 2020-03-13 | C1     | S1   |
| 2020-03-14 | C2     | S2   |
| 2020-03-15 | C3     | S3   |
| ...        | ...    | ...  |

* 房间空调详单格式

| 日期       | 时段        | 风速模式 | 使用时长 | 耗电量 | 费用 |
| ---------- | ----------- | -------- | -------- | ------ | ---- |
| 2020-03-13 | 20:19-22:30 | 高风     | T        | T      | T    |
| 2020-03-13 | 16:29-18:40 | 中风     | T        | T/2    | T/2  |
| 2020-03-13 | 11:09-13:20 | 低风     | T        | T/3    | T/3  |
| ...        | ...         | ...      | ...      | ...    | ...  |

## 5. 技术路线

* 开发语言：python
* 数据库：MySQL / SQLite / SQL server
* 系统：Windows / Linux
* 硬件配置：温度传感器（模拟）

#### 5.1 C/S架构

* 客户端：pyQT / wxPython
* 服务端：Socket / Twisted

## 6. 人员配置

小组总共五名成员，总共分为服务端开发，客户端开发，文档撰写与测试（暂定），可随时调整。